# 🔄 清除缓存并重新加载（重要）

## ✅ 已完成的修复

1. **修复了所有硬编码的 `localhost:3000`**：
   - `src/lib/trpc.ts` ✅
   - `src/pages/profile/index.tsx` ✅
   - `src/pages/admin/index.tsx` ✅（刚刚修复）
   - `src/pages/ai-chat/index.tsx` ✅

2. **已重新编译**：所有代码都已更新并重新编译

---

## 🚨 关键问题

**微信开发者工具缓存了旧的编译结果**，所以即使我们重新编译了，您仍然看到 `http://localhost:3000`。

**解决方案**：必须清除微信开发者工具的缓存。

---

## 📝 操作步骤（必须按顺序执行）

### 步骤1：关闭微信开发者工具

1. **完全关闭微信开发者工具**
2. **确保所有窗口都已关闭**

---

### 步骤2：删除缓存目录（推荐）

**Windows 系统**：

1. **按 `Win + R`**
2. **输入以下路径并按回车**：
   ```
   %APPDATA%\微信开发者工具
   ```
3. **找到并删除以下目录**（如果存在）：
   - `Cache` 目录
   - `Storage` 目录
   - 或者直接删除整个 `微信开发者工具` 目录（会清除所有缓存）

**或者手动导航到**：
```
C:\Users\Administrator\AppData\Roaming\微信开发者工具
```

---

### 步骤3：重新打开微信开发者工具

1. **重新打开微信开发者工具**
2. **重新打开项目**（选择 `dist` 目录或项目根目录）

---

### 步骤4：清除缓存（在工具中）

1. **在微信开发者工具中**
2. **点击"编译"按钮旁边的下拉箭头**
3. **选择"清除缓存"**
4. **选择"清除所有缓存"**（或至少清除"编译缓存"和"文件缓存"）

---

### 步骤5：重新编译

1. **点击"编译"按钮**（或按 `Ctrl+B`）
2. **等待编译完成**

---

### 步骤6：验证配置

1. **打开"调试器"**（点击工具栏的"调试器"按钮）
2. **切换到"Console"标签**
3. **查看日志**，应该看到：
   ```
   [tRPC] API Base URL: https://tci-184647-5-1377481866.sh.run.tcloudbase.com
   ```

---

## 🔍 如果仍然看到 `localhost:3000`

### 方法1：检查编译后的代码

1. **打开 `dist` 目录**
2. **搜索 `localhost:3000`**
3. **如果找到**，说明编译有问题
4. **如果找不到**，说明编译正确，但缓存没清除干净

---

### 方法2：完全重新编译

1. **删除 `dist` 目录**
2. **重新运行编译命令**：
   ```powershell
   powershell -Command "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process -Force; cd d:\tcm-bti-assessment; pnpm build:weapp"
   ```
3. **在微信开发者工具中清除缓存**
4. **重新加载项目**

---

### 方法3：检查项目路径

1. **确认微信开发者工具打开的是 `dist` 目录**
2. **或者确认项目根目录是 `d:\tcm-bti-assessment`**
3. **检查 `project.config.json` 中的路径配置**

---

## ⚠️ 重要提示

- **必须清除缓存**：这是关键步骤，不要跳过
- **关闭工具**：完全关闭微信开发者工具后再重新打开
- **删除缓存目录**：这是最彻底的方法
- **重新编译**：清除缓存后必须重新编译

---

## 🎯 现在请

1. **关闭微信开发者工具**

2. **删除缓存目录**（`%APPDATA%\微信开发者工具\Cache`）

3. **重新打开微信开发者工具**

4. **清除缓存**（在工具中）

5. **重新编译**

6. **查看控制台日志**：
   - 确认 API 地址是云托管地址
   - 查看是否有错误

7. **告诉我结果**：
   - 如果成功，告诉我"连接成功"
   - 如果失败，告诉我具体的错误信息

---

## 💡 提示

- **所有代码已修复**：源代码中所有 `localhost:3000` 都已改为云托管地址
- **已重新编译**：代码已生成在 `dist` 目录
- **问题在缓存**：微信开发者工具缓存了旧的编译结果
- **必须清除缓存**：这是解决问题的关键

**请按照上述步骤操作，特别是删除缓存目录，然后告诉我结果！**
