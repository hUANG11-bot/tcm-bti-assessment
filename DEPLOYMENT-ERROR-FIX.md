# éƒ¨ç½²é”™è¯¯ä¿®å¤

## ğŸš¨ é—®é¢˜åˆ†æ

### âœ… å¥½æ¶ˆæ¯

1. **Docker æ„å»ºæˆåŠŸ** âœ…
   - `check_build_image : succ`
   - `npm install` æˆåŠŸï¼š`added 740 packages in 55s`
   - é•œåƒå·²æ¨é€æˆåŠŸ

### âŒ é—®é¢˜

**è¿è¡Œæ—¶é”™è¯¯**ï¼š
```
Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'express' imported from /app/dist/index.js
```

**åŸå› **ï¼š
- `package.json` ä¸­ `express` ä¸åœ¨ `dependencies` ä¸­
- `npm install --production` åªå®‰è£… `dependencies`ï¼Œä¸å®‰è£… `devDependencies`
- ä½† `express` å¯èƒ½è¢«æ ‡è®°ä¸ºé—´æ¥ä¾èµ–ï¼Œæˆ–è€…éœ€è¦ä» `devDependencies` å®‰è£…

---

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®å¤1ï¼šä¿®æ”¹ Dockerfileï¼ˆå·²ä¿®å¤ï¼‰

**å·²ä¿®æ”¹ Dockerfile**ï¼Œç§»é™¤ `--production` æ ‡å¿—ï¼š

```dockerfile
# å®‰è£…ä¾èµ–ï¼ˆä¸ä½¿ç”¨ --productionï¼Œç¡®ä¿æ‰€æœ‰è¿è¡Œæ—¶ä¾èµ–éƒ½è¢«å®‰è£…ï¼‰
RUN npm install --legacy-peer-deps --timeout=600000 || \
    npm install --no-optional --legacy-peer-deps --timeout=600000 || \
    npm install --timeout=600000 || \
    (echo "ERROR: All npm install attempts failed" && exit 1)
```

**åŸå› **ï¼š
- ä¸ä½¿ç”¨ `--production` ä¼šå®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬ devDependenciesï¼‰
- ç¡®ä¿ `express` å’Œå…¶ä»–è¿è¡Œæ—¶éœ€è¦çš„åŒ…éƒ½è¢«å®‰è£…

---

### ä¿®å¤2ï¼šæ·»åŠ  express åˆ° dependenciesï¼ˆæ¨èï¼‰

**æ›´å¥½çš„é•¿æœŸè§£å†³æ–¹æ¡ˆ**ï¼šåœ¨ `package.json` ä¸­æ·»åŠ  `express` ä½œä¸ºç›´æ¥ä¾èµ–ï¼š

```json
"dependencies": {
  "express": "^4.18.2",
  // ... å…¶ä»–ä¾èµ–
}
```

**ä½†ä¸ºäº†å¿«é€Ÿä¿®å¤ï¼Œå…ˆä½¿ç”¨ä¿®å¤1ã€‚**

---

## ğŸš€ ä¸‹ä¸€æ­¥

### æ­¥éª¤1ï¼šæäº¤ä¿®æ”¹

1. **æäº¤ä¿®æ”¹åçš„ Dockerfile åˆ° GitHub**
2. **æˆ–é‡æ–°åˆ›å»º deploy.zip**ï¼ˆå¦‚æœä½¿ç”¨ä¸Šä¼ æ–¹å¼ï¼‰

### æ­¥éª¤2ï¼šé‡æ–°éƒ¨ç½²

1. **åœ¨å¾®ä¿¡äº‘æ‰˜ç®¡æ§åˆ¶å°**
2. **ç‚¹å‡»"é‡æ–°éƒ¨ç½²"**
3. **ç­‰å¾…æ„å»ºå®Œæˆ**

### æ­¥éª¤3ï¼šæ£€æŸ¥ç»“æœ

**å¦‚æœæˆåŠŸ**ï¼š
- âœ… æœåŠ¡åº”è¯¥æ­£å¸¸è¿è¡Œ
- âœ… ä¸å†å‡ºç° `ERR_MODULE_NOT_FOUND` é”™è¯¯

**å¦‚æœä»ç„¶å¤±è´¥**ï¼š
- è¯·æä¾›æ–°çš„é”™è¯¯ä¿¡æ¯
- æˆ‘å¯ä»¥ç»§ç»­ä¿®å¤

---

## ğŸ“‹ å…¶ä»–é—®é¢˜

### ç”Ÿå‘½å‘¨æœŸé’©å­å¤±è´¥

æ—¥å¿—ä¸­è¿˜æ˜¾ç¤ºï¼š
```
Exec lifecycle hook ([/bin/sh /app/cert/initenv.sh]) failed - error: command exited with 137
```

**è¿™æ˜¯å¾®ä¿¡äº‘æ‰˜ç®¡çš„ç¯å¢ƒåˆå§‹åŒ–è„šæœ¬**ï¼Œé€€å‡ºç  137 é€šå¸¸è¡¨ç¤ºï¼š
- è¿›ç¨‹è¢« SIGKILL æ€æ­»
- å¯èƒ½æ˜¯å†…å­˜ä¸è¶³æˆ–è¶…æ—¶

**è¿™é€šå¸¸ä¸å½±å“æœåŠ¡è¿è¡Œ**ï¼Œä½†å¦‚æœæœåŠ¡æ— æ³•å¯åŠ¨ï¼Œå¯èƒ½éœ€è¦ï¼š
1. å¢åŠ å†…å­˜é™åˆ¶
2. æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ

---

## âœ… ç°åœ¨è¯·

1. **æäº¤ä¿®æ”¹åçš„ Dockerfile åˆ° GitHub**
2. **é‡æ–°éƒ¨ç½²**
3. **æŸ¥çœ‹ç»“æœ**

**å®Œæˆåå‘Šè¯‰æˆ‘ç»“æœï¼**
