# Dockerfile é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

äº‘æ‰˜ç®¡éœ€è¦ Dockerfile æ¥æ„å»ºå’Œè¿è¡Œæ‚¨çš„åº”ç”¨ã€‚æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº† `Dockerfile`ã€‚

---

## âœ… Dockerfile å·²åˆ›å»º

**æ–‡ä»¶ä½ç½®**ï¼š`d:\tcm-bti-assessment\Dockerfile`

**å†…å®¹è¯´æ˜**ï¼š
- ä½¿ç”¨ Node.js 20 Alpine é•œåƒï¼ˆè½»é‡çº§ï¼‰
- å®‰è£… pnpm åŒ…ç®¡ç†å™¨
- å®‰è£…ç”Ÿäº§ä¾èµ–
- å¤åˆ¶åº”ç”¨ä»£ç 
- æš´éœ² 3000 ç«¯å£
- å¯åŠ¨åº”ç”¨

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. ç¡®ä¿ Dockerfile åœ¨å‹ç¼©åŒ…ä¸­

**åˆ›å»ºå‹ç¼©åŒ…æ—¶ï¼Œå¿…é¡»åŒ…å« Dockerfile**ï¼š

```powershell
# åˆ›å»ºå‹ç¼©åŒ…ï¼ˆåŒ…å« Dockerfileï¼‰
Compress-Archive -Path dist,server,shared,package.json,pnpm-lock.yaml,Dockerfile -DestinationPath deploy.zip -Force
```

**æˆ–è€…ä½¿ç”¨è„šæœ¬**ï¼š
```powershell
.\create-deploy.ps1
```
ï¼ˆè„šæœ¬å·²æ›´æ–°ï¼Œä¼šè‡ªåŠ¨åŒ…å« Dockerfileï¼‰

---

### 2. ä¸Šä¼ åˆ°äº‘æ‰˜ç®¡

1. **ä¸Šä¼  `deploy.zip`**
   - ç°åœ¨åº”è¯¥ä¸ä¼šæç¤ºç¼ºå°‘ Dockerfile äº†

2. **å¦‚æœä»ç„¶æç¤ºç¼ºå°‘ Dockerfile**ï¼š
   - å±•å¼€"é«˜çº§è®¾ç½®"
   - æ£€æŸ¥"Dockerfile è·¯å¾„"æ˜¯å¦æ­£ç¡®
   - åº”è¯¥è®¾ç½®ä¸ºï¼š`Dockerfile`ï¼ˆæ ¹ç›®å½•ï¼‰

---

## ğŸ”§ é«˜çº§é…ç½®

### å¦‚æœéœ€è¦åœ¨é«˜çº§è®¾ç½®ä¸­é…ç½®

**Dockerfile è·¯å¾„**ï¼š`Dockerfile`

**æ„å»ºå‘½ä»¤**ï¼ˆé€šå¸¸ä¸éœ€è¦ï¼‰ï¼š
```bash
# äº‘æ‰˜ç®¡ä¼šè‡ªåŠ¨æ‰§è¡Œ Dockerfile ä¸­çš„æ­¥éª¤
```

**å¯åŠ¨å‘½ä»¤**ï¼ˆé€šå¸¸ä¸éœ€è¦ï¼‰ï¼š
```bash
# Dockerfile ä¸­å·²è®¾ç½®ï¼šnode dist/index.js
```

---

## ğŸ“‹ Dockerfile å†…å®¹

```dockerfile
# ä½¿ç”¨å®˜æ–¹ Node.js è¿è¡Œæ—¶ä½œä¸ºåŸºç¡€é•œåƒ
FROM node:20-alpine

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶ package.json å’Œ pnpm-lock.yaml
COPY package.json pnpm-lock.yaml ./

# å®‰è£… pnpm
RUN npm install -g pnpm

# å®‰è£…ä¾èµ–
RUN pnpm install --frozen-lockfile --prod

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY dist ./dist
COPY server ./server
COPY shared ./shared

# æš´éœ²ç«¯å£
EXPOSE 3000

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV NODE_ENV=production
ENV PORT=3000

# å¯åŠ¨åº”ç”¨
CMD ["node", "dist/index.js"]
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸Šä¼ åä»ç„¶æç¤ºç¼ºå°‘ Dockerfileï¼Ÿ

**A**: 
1. **ç¡®è®¤ Dockerfile åœ¨å‹ç¼©åŒ…ä¸­**ï¼š
   - è§£å‹ `deploy.zip` æ£€æŸ¥
   - ç¡®è®¤æ ¹ç›®å½•æœ‰ `Dockerfile` æ–‡ä»¶

2. **æ£€æŸ¥é«˜çº§è®¾ç½®**ï¼š
   - å±•å¼€"é«˜çº§è®¾ç½®"
   - æŸ¥çœ‹"Dockerfile è·¯å¾„"é…ç½®
   - åº”è¯¥è®¾ç½®ä¸ºï¼š`Dockerfile`

3. **é‡æ–°åˆ›å»ºå‹ç¼©åŒ…**ï¼š
   - ç¡®ä¿åŒ…å« Dockerfile
   - é‡æ–°ä¸Šä¼ 

---

### Q2: å¯ä»¥ä½¿ç”¨ CLI å·¥å…·ç”Ÿæˆ Dockerfile å—ï¼Ÿ

**A**: 
- å¯ä»¥ï¼Œä½†æˆ‘ä»¬å·²ç»ä¸ºæ‚¨åˆ›å»ºäº†é€‚åˆçš„ Dockerfile
- å¦‚æœä½¿ç”¨ CLI å·¥å…·ï¼Œç¡®ä¿ç”Ÿæˆçš„ Dockerfile ä¸æˆ‘ä»¬çš„é…ç½®ä¸€è‡´

---

### Q3: Dockerfile éœ€è¦ä¿®æ”¹å—ï¼Ÿ

**A**: 
- **é€šå¸¸ä¸éœ€è¦ä¿®æ”¹**
- å¦‚æœæ‚¨çš„åº”ç”¨æœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¯ä»¥ä¿®æ”¹ï¼š
  - ç«¯å£å·ï¼ˆå½“å‰ï¼š3000ï¼‰
  - Node.js ç‰ˆæœ¬ï¼ˆå½“å‰ï¼š20ï¼‰
  - å¯åŠ¨å‘½ä»¤ï¼ˆå½“å‰ï¼š`node dist/index.js`ï¼‰

---

### Q4: æ„å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: 
1. **æ£€æŸ¥ Dockerfile è¯­æ³•**ï¼š
   - ç¡®è®¤æ²¡æœ‰è¯­æ³•é”™è¯¯
   - ç¡®è®¤è·¯å¾„æ­£ç¡®

2. **æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—**ï¼š
   - åœ¨äº‘æ‰˜ç®¡éƒ¨ç½²é¡µé¢æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   - æŸ¥æ‰¾é”™è¯¯ä¿¡æ¯

3. **æ£€æŸ¥ä»£ç **ï¼š
   - ç¡®è®¤ `dist/index.js` å­˜åœ¨
   - ç¡®è®¤ `package.json` æ­£ç¡®

---

## âœ… æ£€æŸ¥æ¸…å•

### åˆ›å»ºå‹ç¼©åŒ…å‰
- [ ] å·²æ‰§è¡Œ `pnpm build` æ„å»ºä»£ç 
- [ ] å·²ç¡®è®¤ `Dockerfile` å­˜åœ¨
- [ ] å·²ç¡®è®¤ `dist/index.js` å­˜åœ¨

### åˆ›å»ºå‹ç¼©åŒ…æ—¶
- [ ] å‹ç¼©åŒ…åŒ…å« `Dockerfile`
- [ ] å‹ç¼©åŒ…åŒ…å« `dist/`ã€`server/`ã€`shared/`
- [ ] å‹ç¼©åŒ…åŒ…å« `package.json`ã€`pnpm-lock.yaml`

### ä¸Šä¼ å
- [ ] ä¸å†æç¤ºç¼ºå°‘ Dockerfile
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] æœåŠ¡æ­£å¸¸è¿è¡Œ

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¡®è®¤ Dockerfile å­˜åœ¨
```bash
# æ£€æŸ¥ Dockerfile
dir Dockerfile
```

### 2. é‡æ–°åˆ›å»ºå‹ç¼©åŒ…ï¼ˆåŒ…å« Dockerfileï¼‰
```powershell
Compress-Archive -Path dist,server,shared,package.json,pnpm-lock.yaml,Dockerfile -DestinationPath deploy.zip -Force
```

### 3. ä¸Šä¼ åˆ°äº‘æ‰˜ç®¡
- ä¸Šä¼  `deploy.zip`
- åº”è¯¥ä¸å†æç¤ºç¼ºå°‘ Dockerfile

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **Dockerfile é—®é¢˜**ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè·¯å¾„æ˜¯å¦æ­£ç¡®
2. **æ„å»ºå¤±è´¥**ï¼šæŸ¥çœ‹éƒ¨ç½²æ—¥å¿—ï¼Œæ£€æŸ¥ Dockerfile è¯­æ³•
3. **å…¶ä»–é—®é¢˜**ï¼šæŸ¥çœ‹äº‘æ‰˜ç®¡æ–‡æ¡£æˆ–è”ç³»äº‘å¼€å‘å®¢æœ
