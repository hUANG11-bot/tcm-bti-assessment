# SSL证书下载和使用指南

## 📋 当前状态

根据您的证书管理界面：
- **证书状态**：已签发 ✅
- **绑定域名**：er1.store
- **有效期**：90天
- **下一步**：下载证书并上传到平台

---

## 🎯 快速下载步骤

### 步骤1：选择服务器类型

在"下载证书"对话框中，根据您的使用场景选择：

**推荐选择：**
- **Nginx (适用大部分场景)** - 如果您不确定，选择这个
- **其他 (pem文件、crt文件、key文件)** - 通用格式，也推荐

**其他选项：**
- **Apache** - 如果使用Apache服务器
- **IIS** - 如果使用Windows IIS服务器
- **Tomcat** - 如果使用Java Tomcat服务器

### 步骤2：下载证书

1. **点击对应服务器类型的"下载"按钮**
   - 例如：点击"Nginx"行的"下载"按钮
   - 或点击"其他"行的"下载"按钮

2. **下载文件**
   - 系统会下载一个压缩包（通常是 `.zip` 或 `.tar.gz` 格式）
   - 保存到本地

3. **解压文件**
   - 解压下载的压缩包
   - 您会看到以下文件：

---

## 📁 证书文件说明

### Nginx格式（推荐）

解压后会看到：
```
证书包/
├── er1.store.pem      # 证书文件（上传这个作为证书）
├── er1.store.key      # 私钥文件（上传这个作为私钥）
└── er1.store_bundle.pem  # 证书链（可选）
```

**或者：**
```
证书包/
├── certificate.pem    # 证书文件
├── private.key        # 私钥文件
└── chain.pem          # 证书链
```

### Apache格式

```
证书包/
├── er1.store_public.crt  # 证书文件（上传这个作为证书）
├── er1.store.key         # 私钥文件（上传这个作为私钥）
└── er1.store_chain.crt  # 证书链
```

### 其他格式

```
证书包/
├── certificate.crt    # 证书文件
├── private.key        # 私钥文件
└── chain.crt          # 证书链
```

---

## 📤 上传证书到平台

### 步骤1：打开证书文件

1. **打开证书文件**（`.pem` 或 `.crt`）
   - 使用文本编辑器打开（如记事本、VS Code等）
   - 不要使用Word等富文本编辑器

2. **复制全部内容**
   - 包括 `-----BEGIN CERTIFICATE-----`
   - 中间的所有Base64编码内容
   - `-----END CERTIFICATE-----`
   - 如果有多个证书块（证书链），全部复制

### 步骤2：打开私钥文件

1. **打开私钥文件**（`.key` 或 `.pem`）
   - 使用文本编辑器打开

2. **复制全部内容**
   - 包括 `-----BEGIN PRIVATE KEY-----` 或 `-----BEGIN RSA PRIVATE KEY-----`
   - 中间的所有Base64编码内容
   - `-----END PRIVATE KEY-----` 或 `-----END RSA PRIVATE KEY-----`

### 步骤3：上传到平台

在"绑定自定义域名"对话框中：

1. **域名**：输入 `er1.store` 或 `www.er1.store`
2. **关联服务**：选择对应的服务
3. **HTTPS**：确保开关已开启（绿色）
4. **上传签名证书**：
   - 点击"上传签名证书"
   - 粘贴刚才复制的证书文件全部内容
   - 或点击上传按钮选择证书文件
5. **上传签名私钥**：
   - 点击"上传签名私钥"
   - 粘贴刚才复制的私钥文件全部内容
   - 或点击上传按钮选择私钥文件
6. **点击"确定"**完成绑定

---

## 🔍 文件格式说明

### 证书文件格式

**PEM格式（.pem, .crt）：**
```
-----BEGIN CERTIFICATE-----
MIIDXTCCAkWgAwIBAgIJAK...
（多行Base64编码内容）
...
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
（中间证书，如果有）
...
-----END CERTIFICATE-----
```

**关键点：**
- 必须以 `-----BEGIN CERTIFICATE-----` 开头
- 必须以 `-----END CERTIFICATE-----` 结尾
- 中间是Base64编码的内容
- 如果有证书链，会有多个证书块

### 私钥文件格式

**PEM格式（.key, .pem）：**
```
-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0B...
（多行Base64编码内容）
...
-----END PRIVATE KEY-----
```

**或RSA格式：**
```
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA...
（多行Base64编码内容）
...
-----END RSA PRIVATE KEY-----
```

**关键点：**
- 必须以 `-----BEGIN` 开头
- 必须以 `-----END` 结尾
- 中间是Base64编码的内容
- 不要泄露私钥文件

---

## ⚠️ 常见问题

### 问题1：不知道选择哪个服务器类型

**建议：**
- 如果只是上传到平台绑定域名，选择 **"Nginx"** 或 **"其他"**
- 这两种格式都是标准的PEM格式，通用性最好
- 文件格式：`.pem` 或 `.crt`（证书）+ `.key`（私钥）

### 问题2：证书文件内容格式不对

**检查：**
1. 确保包含 `-----BEGIN CERTIFICATE-----` 和 `-----END CERTIFICATE-----`
2. 确保没有多余的空格或换行
3. 如果有证书链，确保包含所有证书块

**解决方法：**
- 使用文本编辑器（记事本、VS Code）打开，不要用Word
- 复制时确保包含完整的BEGIN和END标记
- 如果有多个证书块，全部复制

### 问题3：私钥文件格式不对

**检查：**
1. 确保包含 `-----BEGIN PRIVATE KEY-----` 或 `-----BEGIN RSA PRIVATE KEY-----`
2. 确保包含对应的 `-----END` 标记
3. 确保没有多余的空格

**解决方法：**
- 使用文本编辑器打开
- 复制完整的私钥内容（包括BEGIN和END标记）

### 问题4：上传后提示证书和私钥不匹配

**可能原因：**
- 证书和私钥不是同一对
- 文件内容复制不完整
- 选择了错误的文件

**解决方法：**
1. 重新下载证书包
2. 确保使用同一证书包中的证书和私钥文件
3. 检查文件内容是否完整

### 问题5：下载的文件找不到

**检查位置：**
- 浏览器默认下载文件夹（通常是"下载"文件夹）
- 检查浏览器下载历史
- 检查是否被解压

**解决方法：**
1. 查看浏览器下载记录
2. 检查下载文件夹
3. 如果已解压，检查解压后的文件夹

---

## 📝 完整操作流程

### 1. 下载证书

```
证书管理页面
  ↓
点击"下载"按钮（选择Nginx或其他）
  ↓
下载压缩包
  ↓
解压文件
```

### 2. 准备文件内容

```
打开证书文件（.pem 或 .crt）
  ↓
复制全部内容（包括BEGIN和END标记）
  ↓
打开私钥文件（.key）
  ↓
复制全部内容（包括BEGIN和END标记）
```

### 3. 上传到平台

```
打开"绑定自定义域名"对话框
  ↓
填写域名：er1.store
  ↓
开启HTTPS开关
  ↓
上传证书内容（粘贴或选择文件）
  ↓
上传私钥内容（粘贴或选择文件）
  ↓
点击"确定"
```

---

## ✅ 检查清单

完成以下步骤：

- [ ] 已选择服务器类型（推荐Nginx或其他）
- [ ] 已下载证书压缩包
- [ ] 已解压证书文件
- [ ] 已找到证书文件（.pem 或 .crt）
- [ ] 已找到私钥文件（.key）
- [ ] 已打开证书文件并复制全部内容
- [ ] 已打开私钥文件并复制全部内容
- [ ] 已确认文件包含BEGIN和END标记
- [ ] 已在平台上传证书内容
- [ ] 已在平台上传私钥内容
- [ ] 已点击"确定"完成绑定
- [ ] HTTPS已成功启用

---

## 💡 重要提示

1. **文件格式**：
   - 证书文件：`.pem` 或 `.crt`
   - 私钥文件：`.key` 或 `.pem`
   - 必须包含BEGIN和END标记

2. **文件配对**：
   - 证书和私钥必须来自同一个证书包
   - 不能混用不同证书的证书和私钥

3. **私钥安全**：
   - 私钥文件非常重要，不要泄露
   - 不要将私钥提交到代码仓库
   - 妥善保管私钥文件

4. **证书有效期**：
   - 证书有效期90天
   - 到期前需要续期或重新申请

5. **文件内容**：
   - 复制时确保包含完整的BEGIN和END标记
   - 如果有多个证书块（证书链），全部复制
   - 不要添加或删除任何内容

---

## 🎉 完成

完成以上步骤后，您的域名就可以使用HTTPS了！

访问 `https://er1.store` 应该能看到安全锁图标，表示HTTPS已成功启用。

---

## 📚 相关文档

- [SSL证书和私钥获取指南](./SSL-CERTIFICATE-GUIDE.md)
- [域名验证指南](./DOMAIN-VERIFICATION-GUIDE.md)
- [Let's Encrypt证书详细操作指南](./LETSENCRYPT-SETUP.md)
