# 如何查找您的API地址

## 🔍 查找API地址的方法

根据您的部署方式，API地址的查找方法不同：

---

## 方法1：使用云托管（推荐）

如果您使用微信云开发的云托管服务：

### 步骤1：登录微信公众平台

1. 访问：https://mp.weixin.qq.com
2. 使用小程序管理员账号登录

### 步骤2：进入云托管

1. 点击左侧菜单：**云服务**
2. 选择：**云开发**
3. 点击：**云托管** 标签

### 步骤3：查看服务地址

1. 找到您的云托管服务（环境：`cloud1`）
2. 点击服务名称进入详情页
3. 在服务详情页面中查找：
   - **"访问地址"**
   - **"域名"**
   - **"公网地址"**

**地址格式通常为：**
```
https://服务名-环境ID.cloudbaseapp.com
```

**示例：**
```
https://tcm-api-cloud1-0g2dym0r58f17842.cloudbaseapp.com
```

### 步骤4：复制地址

复制完整的HTTPS地址，这就是您的API地址。

---

## 方法2：使用云函数

如果您使用云函数（不推荐，需要代码改造）：

### 步骤1：登录微信公众平台

1. 访问：https://mp.weixin.qq.com
2. 进入：**云服务** → **云开发** → **云函数**

### 步骤2：查看云函数地址

云函数通常通过小程序直接调用，不需要配置域名。但如果需要HTTP触发地址：

1. 进入云函数详情
2. 查看"HTTP触发"或"访问地址"
3. 复制地址

---

## 方法3：使用自己的服务器

如果您有自己的服务器：

### 步骤1：确认服务器地址

您的API地址应该是：
```
https://您的域名
```

例如：
```
https://api.yourdomain.com
```

### 步骤2：确认服务器配置

1. **确认使用HTTPS**：必须是 `https://` 开头
2. **确认域名已备案**：国内服务器需要ICP备案
3. **确认服务运行**：服务器上的后端服务正在运行

---

## 方法4：检查当前配置

### 检查编译配置

查看项目中的配置文件：

1. **查看 `config/index.js`**：
   ```javascript
   // 查看这里的配置
   TARO_APP_API_URL: JSON.stringify(
     process.env.TARO_APP_API_URL || 'http://localhost:3000'
   )
   ```

2. **查看 `.env` 文件**：
   ```env
   TARO_APP_API_URL=https://你的API地址
   ```

3. **查看编译后的代码**：
   - 打开 `dist` 目录
   - 搜索 `localhost` 或 `http://` 或 `https://`
   - 找到API地址

### 检查小程序代码

在微信开发者工具中：

1. 打开"调试器"
2. 切换到"Console"标签
3. 查看是否有API地址相关的日志
4. 查找类似 `[tRPC] API Base URL:` 的日志

---

## 🎯 快速查找（云托管）

**最快的方法：**

1. **登录微信公众平台**：https://mp.weixin.qq.com
2. **点击左侧菜单**：云服务
3. **选择**：云开发
4. **点击**：云托管
5. **找到您的服务**（环境：cloud1）
6. **点击服务名称**进入详情
7. **查找"访问地址"或"域名"**
8. **复制完整的HTTPS地址**

**或者：**

在"配置服务器域名"页面中，`request合法域名`字段里显示的地址就是您的API地址。

**注意**：
- 如果显示的是测试域名（如：`express-w0qu-xxx.sh.run.tcloudbase.com`），这是测试用的
- 正式发布需要绑定自定义域名
- 使用测试域名时，记得去掉末尾的斜杠 `/`

---

## ⚠️ 重要提示

### API地址的要求

无论使用哪种方式，API地址必须满足：

1. ✅ **使用HTTPS**：必须是 `https://` 开头
2. ✅ **不能使用HTTP**：不能是 `http://`
3. ✅ **不能使用localhost**：不能是 `http://localhost:3000`
4. ✅ **不能使用IP地址**：不能是 `http://192.168.1.1`
5. ✅ **不能包含端口号**：不能是 `https://api.com:3000`（默认443端口）

### 正确的格式

✅ **正确示例：**
```
https://tcm-api-cloud1-0g2dym0r58f17842.cloudbaseapp.com
https://api.yourdomain.com
```

❌ **错误示例：**
```
http://localhost:3000          ❌ 使用了HTTP和localhost
http://api.yourdomain.com      ❌ 使用了HTTP
https://api.yourdomain.com:3000 ❌ 包含了端口号
192.168.1.1                    ❌ 使用了IP地址
```

---

## 🔧 如果找不到API地址

### 情况1：还没有创建云托管服务

**解决方法：**

1. 登录微信公众平台
2. 进入：**云服务** → **云开发** → **云托管**
3. 点击"新建服务"
4. 填写服务名称（如：`tcm-api`）
5. 选择环境：`cloud1`
6. 创建后获取访问地址

### 情况2：服务已创建但找不到地址

**解决方法：**

1. 在云托管列表中，点击服务名称
2. 进入服务详情页面
3. 查看"概览"或"配置"页面
4. 查找"访问地址"、"域名"或"公网地址"

### 情况3：使用自己的服务器

**解决方法：**

1. 确认您的服务器域名
2. 确认服务器已配置HTTPS
3. 确认域名已通过ICP备案
4. API地址就是：`https://您的域名`

---

## 📋 找到API地址后的步骤

找到API地址后，需要：

1. **配置服务器域名**：
   - 微信公众平台 → 开发 → 开发管理 → 开发设置
   - 在"request合法域名"中添加您的API地址

2. **重新编译小程序**：
   ```bash
   set TARO_APP_API_URL=https://您的API地址 && pnpm build:weapp
   ```

3. **清除缓存并重新加载**

---

## 💡 提示

- **云托管地址**：通常在服务详情页面的顶部或"概览"中
- **如果找不到**：可以联系云开发客服或在云开发文档中查找
- **测试地址**：找到地址后，可以在浏览器中访问测试是否可访问

---

## 📞 需要帮助？

如果仍然找不到API地址：

1. **截图云托管页面**：我可以帮您指出地址位置
2. **告诉我您的部署方式**：云托管、云函数还是自己的服务器
3. **查看云开发文档**：https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html
