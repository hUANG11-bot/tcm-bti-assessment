# 🔍 如何查看构建日志（详细步骤）

## 🚨 当前问题

**构建持续失败**：`check_build_image : fail`

**但看不到具体错误信息**，无法定位问题。

---

## 📋 查看构建日志的详细步骤

### 方法1：通过部署发布页面（推荐）

1. **登录微信公众平台**
   - 访问：https://mp.weixin.qq.com

2. **进入云开发控制台**
   - 点击左侧菜单：**云服务** → **云开发**
   - 选择您的环境（如：`prod-0gmxh4f043292a3b`）

3. **进入云托管**
   - 点击左侧菜单：**云托管**
   - 点击您的服务（如：`Zhongyiti`）

4. **查看部署发布**
   - 点击顶部标签：**"部署发布"**
   - 您会看到版本列表（如：`zhongyiti-015`）

5. **查看失败版本的日志**
   - 找到失败的版本（状态显示"失败"）
   - **点击版本名称**（如：`zhongyiti-015`）
   - 或者点击右侧的 **"查看详情"** 或 **"详情"** 按钮

6. **展开构建日志**
   - 在详情页面，找到 **"构建日志"** 或 **"部署日志"** 部分
   - 点击展开按钮（通常是 `▼` 或 `+`）
   - **复制完整的日志内容**

---

### 方法2：通过运行日志页面

1. **进入运行日志**
   - 在云托管服务页面，点击顶部标签：**"运行日志"**

2. **查看构建日志**
   - 如果构建日志显示在这里，可以查看
   - 注意：运行日志通常显示的是运行时日志，不是构建日志

---

### 方法3：通过服务监控页面

1. **进入服务监控**
   - 在云托管服务页面，点击顶部标签：**"服务监控"**

2. **查看事件日志**
   - 可能包含构建相关的事件
   - 查看是否有错误信息

---

## 🔍 在日志中查找的关键信息

### 1. npm install 输出

查找包含以下关键词的行：
- `npm install`
- `npm ERR!`
- `npm WARN`
- `gyp ERR!`
- `make: ***`

### 2. 错误信息

查找包含以下关键词的行：
- `ERROR`
- `FAILED`
- `error`
- `failed`
- `exit code`
- `Exit status`

### 3. 失败步骤

确定失败发生在哪个步骤：
- `FROM node:20` - 基础镜像拉取
- `COPY package.json` - 文件复制
- `RUN npm install` - 依赖安装（最可能失败的地方）
- `COPY dist` - 应用代码复制
- `RUN test -f` - 文件验证

---

## 📝 需要复制的日志内容

**请复制以下内容**：

1. **完整的构建日志**（从 `-----------构建zhongyiti-XXX-----------` 开始）
2. **特别是 `npm install` 部分的输出**（如果能看到）
3. **任何错误信息**（包含 `ERROR`、`FAILED`、`npm ERR!` 的行）

---

## 💡 如果找不到构建日志

### 选项1：联系云开发客服

1. 在云开发控制台，找到 **"帮助"** 或 **"客服"** 入口
2. 提供以下信息：
   - 服务名称：`Zhongyiti`
   - 失败版本：`zhongyiti-015`
   - 错误信息：`check_build_image : fail`
   - 请求：查看详细的构建日志

### 选项2：使用云托管 CLI

如果安装了云托管 CLI 工具，可以尝试：
```bash
# 查看构建日志
tcb cloudbase:logs --env prod-0gmxh4f043292a3b
```

### 选项3：检查其他位置

- 检查是否有 **"事件"** 或 **"通知"** 页面
- 检查是否有 **"错误详情"** 链接
- 检查是否有 **"下载日志"** 按钮

---

## 🚨 如果没有构建日志

如果确实无法查看构建日志，可以尝试：

### 方案1：联系云开发技术支持

提供以下信息：
- AppID：`wx9811089020af2ae3`
- 环境名称：`prod-0gmxh4f043292a3b`
- 服务名称：`Zhongyiti`
- 失败版本：`zhongyiti-015`
- 问题：Docker 镜像构建失败，需要查看详细构建日志

### 方案2：尝试本地构建测试

在本地测试 Dockerfile 是否能正常构建：
```bash
# 在项目目录下
docker build -t test-image .
```

如果本地构建成功，可能是云托管环境的问题。
如果本地构建也失败，可以看到具体错误。

---

## 📞 下一步

**请尝试以上方法，找到构建日志并复制给我。**

有了详细的构建日志，我可以：
1. 准确定位问题
2. 提供针对性的解决方案
3. 修复 Dockerfile

---

## ⚠️ 重要提示

**没有详细的构建日志，我无法准确定位问题。**

请务必：
1. 按照上述步骤查找构建日志
2. 复制完整的日志内容
3. 特别是 `npm install` 部分的输出
4. 任何错误信息

这样我才能根据具体错误进一步优化。
