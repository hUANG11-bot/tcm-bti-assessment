# 启动服务指南

## ✅ 部署成功

**好消息**：
- ✅ Docker 构建成功
- ✅ 镜像推送成功
- ✅ 部署完成
- ✅ 服务状态：正常

**但**：
- ⚠️ 实例数量：0个实例 (自动暂停)

---

## 🚀 下一步：启动服务

### 方法1：通过"发布"按钮启动（推荐）

1. **在"部署发布"页面**
2. **点击绿色的"发布"按钮**
3. **选择要发布的版本**（应该只有一个版本）
4. **确认发布**
5. **等待实例启动**

---

### 方法2：检查服务设置

如果"发布"按钮无法启动，需要检查服务配置：

1. **点击"服务设置"标签**
2. **检查以下配置**：

#### 2.1 实例配置
- **最小实例数**：应该设置为至少 1
- **最大实例数**：根据需求设置
- **自动暂停**：如果启用了，服务会在无流量时暂停

#### 2.2 环境变量
确保以下环境变量已配置：
- `WX_APPID` - 微信 AppID
- `WX_SECRET` - 微信 Secret
- `JWT_SECRET` - JWT 密钥
- `DATABASE_URL` - 数据库连接字符串
- `AI_PROVIDER` - AI 服务提供商
- `AI_API_KEY` - AI API 密钥
- `AI_API_URL` - AI API URL（可选）
- `PORT` - 端口（默认 3000）
- `NODE_ENV` - 环境（production）

#### 2.3 资源限制
- **CPU**：至少 0.5 核
- **内存**：至少 512MB（推荐 1GB）

---

### 方法3：检查运行日志

1. **点击"运行日志"标签**
2. **查看最近的日志**
3. **检查是否有错误信息**

**常见问题**：
- 环境变量缺失
- 数据库连接失败
- 端口冲突
- 内存不足

---

## 📋 检查清单

在启动服务前，请确认：

- [ ] 环境变量已正确配置
- [ ] 数据库连接字符串正确
- [ ] 微信 AppID 和 Secret 正确
- [ ] 实例配置合理（至少 1 个实例）
- [ ] 资源限制足够（至少 512MB 内存）

---

## 🔍 如果服务启动失败

### 检查运行日志

1. **点击"运行日志"标签**
2. **查看错误信息**
3. **常见错误**：

#### 错误1：环境变量缺失
```
Error: Missing required environment variable: DATABASE_URL
```
**解决**：在"服务设置"中添加缺失的环境变量

#### 错误2：数据库连接失败
```
Error: connect ECONNREFUSED
```
**解决**：检查 `DATABASE_URL` 是否正确

#### 错误3：端口冲突
```
Error: listen EADDRINUSE: address already in use :::3000
```
**解决**：检查 `PORT` 环境变量，或使用默认端口

#### 错误4：内存不足
```
Error: JavaScript heap out of memory
```
**解决**：增加内存限制（至少 1GB）

---

## ✅ 服务启动后的验证

服务启动成功后，应该看到：

1. **实例数量**：至少 1 个实例运行
2. **服务状态**：正常运行
3. **运行日志**：显示服务启动信息

**验证服务是否正常**：

1. **查看运行日志**，应该看到类似：
   ```
   Server started on port 3000
   ```

2. **测试 API 端点**（如果有公开端点）

---

## 🎯 现在请

1. **点击"发布"按钮**，尝试启动服务
2. **如果失败，检查"服务设置"**中的配置
3. **查看"运行日志"**，找出问题
4. **告诉我结果**

---

## 💡 提示

- **自动暂停**：如果服务长时间无流量，可能会自动暂停
- **手动启动**：可以通过"发布"按钮手动启动
- **监控**：启动后可以在"服务监控"中查看服务状态
