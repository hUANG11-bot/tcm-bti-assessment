/*! For license information please see index.js.LICENSE.txt */
"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[481],{8395:function(e,n,r){var t=r(3897),o=r(758),a=r(5490),s=r(1093),c=r.n(s),i=r(2926),l=r(486),u=r(4476),d=r(6070);function f(){var e,n,r="function"==typeof Symbol?Symbol:{},t=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,t,o,a){var i=t&&t.prototype instanceof c?t:c,l=Object.create(i.prototype);return h(l,"_invoke",function(r,t,o){var a,c,i,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(n,r){return a=n,c=0,i=e,f.n=r,s}};function h(r,t){for(c=r,i=t,n=0;!d&&l&&!o&&n<u.length;n++){var o,a=u[n],h=f.p,m=a[2];r>3?(o=m===t)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=h&&((o=r<2&&h<a[1])?(c=0,f.v=t,f.n=a[1]):h<m&&(o=r<3||a[0]>t||t>m)&&(a[4]=r,a[5]=t,f.n=m,c=0))}if(o||r>1)return s;throw d=!0,t}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),c=u,i=m;(n=c<2?e:i)||!d;){a||(c?c<3?(c>1&&(f.n=-1),h(c,i)):f.n=i:f.v=i);try{if(l=2,a){if(c||(o="next"),n=a[o]){if(!(n=n.call(a,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,c<2&&(c=0)}else 1===c&&(n=a["return"])&&n.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((n=(d=f.n<0)?i:r.call(t,f))!==s)break}catch(n){a=e,c=1,i=n}finally{l=1}}return{value:n,done:d}}}(r,o,a),!0),l}var s={};function c(){}function i(){}function l(){}n=Object.getPrototypeOf;var u=[][t]?n(n([][t]())):(h(n={},t,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,h(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return i.prototype=l,h(d,"constructor",l),h(l,"constructor",i),i.displayName="GeneratorFunction",h(l,o,"GeneratorFunction"),h(d),h(d,o,"Generator"),h(d,t,function(){return this}),h(d,"toString",function(){return"[object Generator]"}),(f=function(){return{w:a,m:m}})()}function h(e,n,r,t){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}h=function(e,n,r,t){function a(n,r){h(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!t,configurable:!t,writable:!t}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},h(e,n,r,t)}function m(e,n,r,t,o,a,s){try{var c=e[a](s),i=c.value}catch(e){return void r(e)}c.done?n(i):Promise.resolve(i).then(t,o)}function p(e){return function(){var n=this,r=arguments;return new Promise(function(t,o){var a=e.apply(n,r);function s(e){m(a,t,o,s,c,"next",e)}function c(e){m(a,t,o,s,c,"throw",e)}s(void 0)})}}function v(e,n){return y(e)||g(e,n)||x(e,n)||j()}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,n){if(e){if("string"==typeof e)return b(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,n):void 0}}function b(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}function g(e,n){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,a,s,c=[],i=!0,l=!1;try{if(a=(r=r.call(e)).next,0===n){if(Object(r)!==r)return;i=!1}else for(;!(i=(t=a.call(r)).done)&&(c.push(t.value),c.length!==n);i=!0);}catch(e){l=!0,o=e}finally{try{if(!i&&null!=r["return"]&&(s=r["return"](),Object(s)!==s))return}finally{if(l)throw o}}return c}}function y(e){if(Array.isArray(e))return e}function w(){var e=(0,i.A)(),n=e.user,r=e.loading,t=e.isAuthenticated,s=e.logout,h=e.refresh,m=(0,o.useState)(!1),j=v(m,2),x=j[0],b=j[1],g=function(){var e=p(f().m(function e(){var n,r,t,o,a,s,i,l;return f().w(function(e){while(1)switch(e.p=e.n){case 0:return b(!0),e.p=1,e.n=2,c().login();case 2:if(n=e.v,n.code){e.n=3;break}throw new Error("\u83b7\u53d6\u5fae\u4fe1\u767b\u5f55\u51ed\u8bc1\u5931\u8d25");case 3:return e.p=3,e.n=4,c().getUserProfile({desc:"\u7528\u4e8e\u5b8c\u5584\u7528\u6237\u8d44\u6599"});case 4:return r=e.v,t="https://er1.store",e.n=5,c().request({url:"".concat(t,"/api/wechat/login"),method:"POST",header:{"Content-Type":"application/json"},data:{code:n.code,userInfo:r.userInfo}});case 5:if(o=e.v,200!==o.statusCode||!o.data.success){e.n=7;break}return c().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),e.n=6,h();case 6:e.n=8;break;case 7:throw new Error(o.data.message||"\u767b\u5f55\u5931\u8d25");case 8:e.n=15;break;case 9:if(e.p=9,i=e.v,!i.errMsg||!i.errMsg.includes("getUserProfile:fail")){e.n=14;break}return a="https://er1.store",e.n=10,c().request({url:"".concat(a,"/api/wechat/login"),method:"POST",header:{"Content-Type":"application/json"},data:{code:n.code}});case 10:if(s=e.v,200!==s.statusCode||!s.data.success){e.n=12;break}return c().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),e.n=11,h();case 11:e.n=13;break;case 12:throw new Error(s.data.message||"\u767b\u5f55\u5931\u8d25");case 13:e.n=15;break;case 14:throw i;case 15:e.n=17;break;case 16:e.p=16,l=e.v,console.error("\u5fae\u4fe1\u767b\u5f55\u5931\u8d25:",l),c().showToast({title:l.message||"\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",icon:"none",duration:2e3});case 17:return e.p=17,b(!1),e.f(17);case 18:return e.a(2)}},e,null,[[3,9],[1,16,17,18]])}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=p(f().m(function e(){var n;return f().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,s();case 1:c().showToast({title:"\u5df2\u9000\u51fa\u767b\u5f55",icon:"success"}),e.n=3;break;case 2:e.p=2,n=e.v,console.error("\u9000\u51fa\u767b\u5f55\u5931\u8d25:",n),c().showToast({title:"\u9000\u51fa\u767b\u5f55\u5931\u8d25",icon:"none"});case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),w=function(){return null!==n&&void 0!==n&&n.avatar?n.avatar:"https://via.placeholder.com/100?text=User"},N=function(){return null!==n&&void 0!==n&&n.name?n.name:null!==n&&void 0!==n&&n.openId?"\u7528\u6237".concat(n.openId.slice(-4)):"\u672a\u767b\u5f55"};return(0,d.jsx)(a.BM,{className:"profile-page",scrollY:!0,children:(0,d.jsxs)(a.Ss,{className:"profile-container",children:[(0,d.jsx)(l.Zp,{className:"user-info-card",children:(0,d.jsx)(l.Wu,{children:r?(0,d.jsx)(a.Ss,{className:"loading-container",children:(0,d.jsx)(a.EY,{children:"\u52a0\u8f7d\u4e2d..."})}):t&&n?(0,d.jsxs)(a.Ss,{className:"user-info",children:[(0,d.jsx)(a._V,{src:w(),className:"user-avatar",mode:"aspectFill"}),(0,d.jsxs)(a.Ss,{className:"user-details",children:[(0,d.jsx)(a.EY,{className:"user-name",children:N()}),n.email&&(0,d.jsx)(a.EY,{className:"user-email",children:n.email}),n.openId&&(0,d.jsxs)(a.EY,{className:"user-id",children:["ID: ",n.openId.slice(-8)]})]})]}):(0,d.jsxs)(a.Ss,{className:"not-logged-in",children:[(0,d.jsx)(a.EY,{className:"not-logged-in-text",children:"\u60a8\u8fd8\u672a\u767b\u5f55"}),(0,d.jsx)(a.EY,{className:"not-logged-in-desc",children:"\u767b\u5f55\u540e\u53ef\u4ee5\u4fdd\u5b58\u6d4b\u8bc4\u8bb0\u5f55\uff0c\u67e5\u770b\u5386\u53f2\u6570\u636e"})]})})}),(0,d.jsx)(a.Ss,{className:"action-section",children:t?(0,d.jsx)(u.$,{variant:"outline",onClick:y,className:"logout-button",children:"\u9000\u51fa\u767b\u5f55"}):(0,d.jsx)(u.$,{onClick:g,disabled:x,className:"login-button",children:x?"\u767b\u5f55\u4e2d...":"\u5fae\u4fe1\u4e00\u952e\u767b\u5f55"})}),t&&(0,d.jsx)(a.Ss,{className:"menu-section",children:(0,d.jsxs)(l.Zp,{children:[(0,d.jsx)(l.aR,{children:(0,d.jsx)(l.ZB,{children:"\u6211\u7684\u529f\u80fd"})}),(0,d.jsxs)(l.Wu,{children:[(0,d.jsxs)(a.Ss,{className:"menu-item",onClick:function(){return c().navigateTo({url:"/pages/invite/index"})},children:[(0,d.jsx)(a.EY,{className:"menu-item-text",children:"\u9080\u8bf7\u597d\u53cb"}),(0,d.jsx)(a.EY,{className:"menu-item-arrow",children:"\u203a"})]}),(0,d.jsxs)(a.Ss,{className:"menu-item",onClick:function(){c().showToast({title:"\u529f\u80fd\u5f00\u53d1\u4e2d",icon:"none"})},children:[(0,d.jsx)(a.EY,{className:"menu-item-text",children:"\u6211\u7684\u6536\u85cf"}),(0,d.jsx)(a.EY,{className:"menu-item-arrow",children:"\u203a"})]}),(0,d.jsxs)(a.Ss,{className:"menu-item",onClick:function(){c().showToast({title:"\u529f\u80fd\u5f00\u53d1\u4e2d",icon:"none"})},children:[(0,d.jsx)(a.EY,{className:"menu-item-text",children:"\u8bbe\u7f6e"}),(0,d.jsx)(a.EY,{className:"menu-item-arrow",children:"\u203a"})]})]})]})}),(0,d.jsx)(a.Ss,{className:"about-section",children:(0,d.jsxs)(l.Zp,{children:[(0,d.jsx)(l.aR,{children:(0,d.jsx)(l.ZB,{children:"\u5173\u4e8e"})}),(0,d.jsx)(l.Wu,{children:(0,d.jsxs)(a.EY,{className:"about-text",children:["TCM-BTI \u4e2d\u533b\u4f53\u8d28\u8bc4\u4f30\u7cfb\u7edf","\n","\u7248\u672c 1.0.0","\n","\u63a2\u5bfb\u8eab\u4f53\u7684\u5c71\u6c34\u753b\u5377\uff0c\u89e3\u7801\u60a8\u7684\u4f53\u8d28\u8bed\u8a00"]})})]})})]})})}var N={};Page((0,t.createPageConfig)(w,"pages/profile/index",{root:{cn:[]}},N||{}))}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[907,96,76],function(){return n(8395)});e.O()}]);