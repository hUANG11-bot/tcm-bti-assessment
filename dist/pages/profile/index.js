/*! For license information please see index.js.LICENSE.txt */
"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[481],{8395:function(e,n,t){var r=t(3897),o=t(758),s=t(5490),a=t(1093),c=t.n(a),i=t(2926),l=t(486),u=t(4476),d=t(3148),f=t(6070);function h(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function s(t,r,o,s){var i=r&&r.prototype instanceof c?r:c,l=Object.create(i.prototype);return m(l,"_invoke",function(t,r,o){var s,c,i,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(n,t){return s=n,c=0,i=e,f.n=t,a}};function h(t,r){for(c=t,i=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,s=u[n],h=f.p,m=s[2];t>3?(o=m===r)&&(i=s[(c=s[4])?5:(c=3,3)],s[4]=s[5]=e):s[0]<=h&&((o=t<2&&h<s[1])?(c=0,f.v=r,f.n=s[1]):h<m&&(o=t<3||s[0]>r||r>m)&&(s[4]=t,s[5]=r,f.n=m,c=0))}if(o||t>1)return a;throw d=!0,r}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),c=u,i=m;(n=c<2?e:i)||!d;){s||(c?c<3?(c>1&&(f.n=-1),h(c,i)):f.n=i:f.v=i);try{if(l=2,s){if(c||(o="next"),n=s[o]){if(!(n=n.call(s,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,c<2&&(c=0)}else 1===c&&(n=s["return"])&&n.call(s),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);s=e}else if((n=(d=f.n<0)?i:t.call(r,f))!==a)break}catch(n){s=e,c=1,i=n}finally{l=1}}return{value:n,done:d}}}(t,o,s),!0),l}var a={};function c(){}function i(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(m(n={},r,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,m(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return i.prototype=l,m(d,"constructor",l),m(l,"constructor",i),i.displayName="GeneratorFunction",m(l,o,"GeneratorFunction"),m(d),m(d,o,"Generator"),m(d,r,function(){return this}),m(d,"toString",function(){return"[object Generator]"}),(h=function(){return{w:s,m:f}})()}function m(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}m=function(e,n,t,r){function s(n,t){m(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(s("next",0),s("throw",1),s("return",2))},m(e,n,t,r)}function p(e,n,t,r,o,s,a){try{var c=e[s](a),i=c.value}catch(e){return void t(e)}c.done?n(i):Promise.resolve(i).then(r,o)}function v(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var s=e.apply(n,t);function a(e){p(s,r,o,a,c,"next",e)}function c(e){p(s,r,o,a,c,"throw",e)}a(void 0)})}}function j(e,n){return w(e)||y(e,n)||b(e,n)||x()}function x(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,n){if(e){if("string"==typeof e)return g(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?g(e,n):void 0}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function y(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,s,a,c=[],i=!0,l=!1;try{if(s=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;i=!1}else for(;!(i=(r=s.call(t)).done)&&(c.push(r.value),c.length!==n);i=!0);}catch(e){l=!0,o=e}finally{try{if(!i&&null!=t["return"]&&(a=t["return"](),Object(a)!==a))return}finally{if(l)throw o}}return c}}function w(e){if(Array.isArray(e))return e}function N(){var e=(0,i.A)(),n=e.user,t=e.loading,r=e.isAuthenticated,a=e.logout,m=e.refresh,p=(0,o.useState)(!1),x=j(p,2),b=x[0],g=x[1],y=function(){var e=v(h().m(function e(){var n,t,r,o,s,a,i,l;return h().w(function(e){while(1)switch(e.p=e.n){case 0:return g(!0),e.p=1,e.n=2,c().login();case 2:if(n=e.v,n.code){e.n=3;break}throw new Error("\u83b7\u53d6\u5fae\u4fe1\u767b\u5f55\u51ed\u8bc1\u5931\u8d25");case 3:return e.p=3,e.n=4,c().getUserProfile({desc:"\u7528\u4e8e\u5b8c\u5584\u7528\u6237\u8d44\u6599"});case 4:return t=e.v,r="https://er1.store",e.n=5,c().request({url:"".concat(r,"/api/wechat/login"),method:"POST",header:{"Content-Type":"application/json"},data:{code:n.code,userInfo:t.userInfo}});case 5:if(o=e.v,200!==o.statusCode||!o.data.success){e.n=7;break}return o.data.sessionToken&&(0,d.Q4)(o.data.sessionToken),c().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),e.n=6,m();case 6:e.n=8;break;case 7:throw new Error(o.data.message||"\u767b\u5f55\u5931\u8d25");case 8:e.n=15;break;case 9:if(e.p=9,i=e.v,!i.errMsg||!i.errMsg.includes("getUserProfile:fail")){e.n=14;break}return s="https://er1.store",e.n=10,c().request({url:"".concat(s,"/api/wechat/login"),method:"POST",header:{"Content-Type":"application/json"},data:{code:n.code}});case 10:if(a=e.v,200!==a.statusCode||!a.data.success){e.n=12;break}return a.data.sessionToken&&(0,d.Q4)(a.data.sessionToken),c().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),e.n=11,m();case 11:e.n=13;break;case 12:throw new Error(a.data.message||"\u767b\u5f55\u5931\u8d25");case 13:e.n=15;break;case 14:throw i;case 15:e.n=17;break;case 16:e.p=16,l=e.v,console.error("\u5fae\u4fe1\u767b\u5f55\u5931\u8d25:",l),c().showToast({title:l.message||"\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",icon:"none",duration:2e3});case 17:return e.p=17,g(!1),e.f(17);case 18:return e.a(2)}},e,null,[[3,9],[1,16,17,18]])}));return function(){return e.apply(this,arguments)}}(),w=function(){var e=v(h().m(function e(){var n;return h().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,a();case 1:c().showToast({title:"\u5df2\u9000\u51fa\u767b\u5f55",icon:"success"}),e.n=3;break;case 2:e.p=2,n=e.v,console.error("\u9000\u51fa\u767b\u5f55\u5931\u8d25:",n),c().showToast({title:"\u9000\u51fa\u767b\u5f55\u5931\u8d25",icon:"none"});case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),N=function(){return null!==n&&void 0!==n&&n.avatar?n.avatar:"https://via.placeholder.com/100?text=User"},T=function(){return null!==n&&void 0!==n&&n.name?n.name:null!==n&&void 0!==n&&n.openId?"\u7528\u6237".concat(n.openId.slice(-4)):"\u672a\u767b\u5f55"};return(0,f.jsx)(s.BM,{className:"profile-page",scrollY:!0,children:(0,f.jsxs)(s.Ss,{className:"profile-container",children:[(0,f.jsx)(l.Zp,{className:"user-info-card",children:(0,f.jsx)(l.Wu,{children:t?(0,f.jsx)(s.Ss,{className:"loading-container",children:(0,f.jsx)(s.EY,{children:"\u52a0\u8f7d\u4e2d..."})}):r&&n?(0,f.jsxs)(s.Ss,{className:"user-info",children:[(0,f.jsx)(s._V,{src:N(),className:"user-avatar",mode:"aspectFill"}),(0,f.jsxs)(s.Ss,{className:"user-details",children:[(0,f.jsx)(s.EY,{className:"user-name",children:T()}),n.email&&(0,f.jsx)(s.EY,{className:"user-email",children:n.email}),n.openId&&(0,f.jsxs)(s.EY,{className:"user-id",children:["ID: ",n.openId.slice(-8)]})]})]}):(0,f.jsxs)(s.Ss,{className:"not-logged-in",children:[(0,f.jsx)(s.EY,{className:"not-logged-in-text",children:"\u60a8\u8fd8\u672a\u767b\u5f55"}),(0,f.jsx)(s.EY,{className:"not-logged-in-desc",children:"\u767b\u5f55\u540e\u53ef\u4ee5\u4fdd\u5b58\u6d4b\u8bc4\u8bb0\u5f55\uff0c\u67e5\u770b\u5386\u53f2\u6570\u636e"})]})})}),(0,f.jsx)(s.Ss,{className:"action-section",children:r?(0,f.jsx)(u.$,{variant:"outline",onClick:w,className:"logout-button",children:"\u9000\u51fa\u767b\u5f55"}):(0,f.jsx)(u.$,{onClick:y,disabled:b,className:"login-button",children:b?"\u767b\u5f55\u4e2d...":"\u5fae\u4fe1\u4e00\u952e\u767b\u5f55"})}),r&&(0,f.jsx)(s.Ss,{className:"menu-section",children:(0,f.jsxs)(l.Zp,{children:[(0,f.jsx)(l.aR,{children:(0,f.jsx)(l.ZB,{children:"\u6211\u7684\u529f\u80fd"})}),(0,f.jsxs)(l.Wu,{children:[(0,f.jsxs)(s.Ss,{className:"menu-item",onClick:function(){return c().navigateTo({url:"/pages/ai-chat/index"})},children:[(0,f.jsx)(s.EY,{className:"menu-item-text",children:"\u95ee\u95eeAI"}),(0,f.jsx)(s.EY,{className:"menu-item-arrow",children:"\u203a"})]}),(0,f.jsxs)(s.Ss,{className:"menu-item",onClick:function(){return c().navigateTo({url:"/pages/assessment-history/index"})},children:[(0,f.jsx)(s.EY,{className:"menu-item-text",children:"\u5386\u53f2\u8bb0\u5f55"}),(0,f.jsx)(s.EY,{className:"menu-item-arrow",children:"\u203a"})]}),(0,f.jsxs)(s.Ss,{className:"menu-item",onClick:function(){c().showToast({title:"\u529f\u80fd\u5f00\u53d1\u4e2d",icon:"none"})},children:[(0,f.jsx)(s.EY,{className:"menu-item-text",children:"\u6211\u7684\u6536\u85cf"}),(0,f.jsx)(s.EY,{className:"menu-item-arrow",children:"\u203a"})]}),(0,f.jsxs)(s.Ss,{className:"menu-item",onClick:function(){c().showToast({title:"\u529f\u80fd\u5f00\u53d1\u4e2d",icon:"none"})},children:[(0,f.jsx)(s.EY,{className:"menu-item-text",children:"\u8bbe\u7f6e"}),(0,f.jsx)(s.EY,{className:"menu-item-arrow",children:"\u203a"})]})]})]})}),(0,f.jsx)(s.Ss,{className:"about-section",children:(0,f.jsxs)(l.Zp,{children:[(0,f.jsx)(l.aR,{children:(0,f.jsx)(l.ZB,{children:"\u5173\u4e8e"})}),(0,f.jsx)(l.Wu,{children:(0,f.jsxs)(s.EY,{className:"about-text",children:["TCM-BTI \u4e2d\u533b\u4f53\u8d28\u8bc4\u4f30\u7cfb\u7edf","\n","\u7248\u672c 1.0.0","\n","\u63a2\u5bfb\u8eab\u4f53\u7684\u5c71\u6c34\u753b\u5377\uff0c\u89e3\u7801\u60a8\u7684\u4f53\u8d28\u8bed\u8a00"]})})]})})]})})}var T={};Page((0,r.createPageConfig)(N,"pages/profile/index",{root:{cn:[]}},T||{}))}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[907,96,76],function(){return n(8395)});e.O()}]);