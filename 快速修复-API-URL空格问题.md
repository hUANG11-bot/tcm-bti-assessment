# 快速修复 API URL 空格问题

## 问题

错误信息显示：`apiBaseUrl: "https://er1.store "`（末尾有空格），导致所有API请求失败。

## 立即修复步骤

### 步骤1：检查微信开发者工具配置

1. **打开微信开发者工具**
2. **点击右上角的"详情"按钮**（或按 `Ctrl+Shift+D`）
3. **选择"本地设置"标签页**
4. **查找以下配置项**：
   - "服务器地址"
   - "API地址"  
   - "request合法域名"
   - 或任何包含 `https://er1.store` 的配置

5. **确保URL末尾没有空格**：
   - ❌ 错误：`https://er1.store `（末尾有空格）
   - ✅ 正确：`https://er1.store`（无空格）

6. **保存配置**

### 步骤2：清除缓存并重新编译

1. **清除缓存**：
   - 点击菜单：`工具` → `清除缓存` → `清除全部`
   - 或按快捷键：`Ctrl+Shift+C`

2. **重新编译**：
   - 点击"编译"按钮
   - 或按快捷键：`Ctrl+B`

### 步骤3：验证修复

重新编译后，在控制台中应该看到：
- ✅ 不再出现 `ERR_NAME_NOT_RESOLVED` 错误
- ✅ API请求URL应该是 `https://er1.store/api/...`（无空格）

## 如果问题仍然存在

### 方法A：使用修复脚本

如果已经编译了前端代码，运行：

```bash
npm run fix:api-url
```

然后重新在微信开发者工具中编译。

### 方法B：检查环境变量

如果使用环境变量配置，检查：
- `.env` 文件
- 系统环境变量
- 微信开发者工具的环境变量

确保 `TARO_APP_API_URL` 或类似变量值末尾没有空格。

### 方法C：手动修复编译后的文件

1. 在微信开发者工具中，找到 `dist/common.js` 文件
2. 搜索 `er1.store `（注意末尾有空格）
3. 替换为 `er1.store`（无空格）
4. 保存文件
5. 重新编译

## 预防措施

为了避免将来再次出现此问题：

1. **在配置URL时，始终使用 `.trim()`**：
   ```javascript
   const apiUrl = (process.env.API_URL || 'https://er1.store').trim();
   ```

2. **在复制粘贴URL时，注意不要包含末尾空格**

3. **定期运行修复脚本**：
   ```bash
   npm run fix:api-url
   ```
